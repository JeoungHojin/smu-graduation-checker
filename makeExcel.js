const xlsx = require('xlsx');



// 사용자의 실제 수강 내역 (이미지 기반 변환)
const myData = [
  // [교양]
  { "학수번호": "HBLA5201", "교과목명": "컴퓨팅사고와데이터의이해", "이수구분": "교필", "학점": 2 },
  { "학수번호": "HBLC5045", "교과목명": "자연과학의이해", "이수구분": "교선", "학점": 3 },
  { "학수번호": "HBLG9053", "교과목명": "교양과인성(소프트웨어학과)", "이수구분": "교선", "학점": 1 },
  { "학수번호": "HBLR2040", "교과목명": "중국어입문", "이수구분": "교선", "학점": 2 },
  { "학수번호": "HBLA5001", "교과목명": "사고와표현", "이수구분": "교필", "학점": 3 },
  { "학수번호": "HBLA5202", "교과목명": "알고리즘과게임콘텐츠", "이수구분": "교필", "학점": 2 },
  { "학수번호": "HBLA5210", "교과목명": "EnglishforAcademicPurposes", "이수구분": "교필", "학점": 3 },
  { "학수번호": "HBLG2046", "교과목명": "천안의이해", "이수구분": "교선", "학점": 2 },
  { "학수번호": "HBLG9040", "교과목명": "인물로보는역사", "이수구분": "교선", "학점": 3 },
  { "학수번호": "HBLB5064", "교과목명": "하이테크사회의인간관계론", "이수구분": "교선", "학점": 3 },
  { "학수번호": "HCLC5050", "교과목명": "기업가정신과창업모델", "이수구분": "교선", "학점": 3 },
  { "학수번호": "HBLA5052", "교과목명": "융합창의수학", "이수구분": "교필", "학점": 2 },
  { "학수번호": "HBLB5071", "교과목명": "빅히스토리와인공지능", "이수구분": "교필", "학점": 3 },
  { "학수번호": "HBLD5029", "교과목명": "웨이트트레이닝", "이수구분": "교선", "학점": 2 },
  { "학수번호": "HBLF0024", "교과목명": "기업경영과비즈니스전략", "이수구분": "교선", "학점": 3 },
  { "학수번호": "HBLB5031", "교과목명": "발명과창업", "이수구분": "교선", "학점": 3 },

  // [일반선택]
  { "학수번호": "HBRT1004", "교과목명": "전쟁사", "이수구분": "일선", "학점": 2 },
  { "학수번호": "HBJE2161", "교과목명": "경영통계학", "이수구분": "일선", "학점": 3 },
  { "학수번호": "HBJE4301", "교과목명": "금융상품론", "이수구분": "일선", "학점": 3 },
  { "학수번호": "HBJE4482", "교과목명": "재무설계II", "이수구분": "일선", "학점": 3 },

  // [전공] - 시스템이 계산할 핵심 데이터
  { "학수번호": "HBJO2173", "교과목명": "컴퓨터프로그래밍 I (PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2193", "교과목명": "소프트웨어개론(SW)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2216", "교과목명": "확률통계(Flip)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2161", "교과목명": "컴퓨터프로그래밍II(PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2225", "교과목명": "컴퓨터프로그래밍실습(PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJW0001", "교과목명": "이산수학", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2122", "교과목명": "컴퓨터구조", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2177", "교과목명": "객체지향프로그래밍", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2226", "교과목명": "데이터구조실습(PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJW0006", "교과목명": "데이터구조(PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJW0012", "교과목명": "리눅스프로그래밍(PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2184", "교과목명": "데이터베이스", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2178", "교과목명": "네트워크(PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2223", "교과목명": "소프트웨어공학(PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJO2236", "교과목명": "인공지능(PBL)", "이수구분": "1전선", "학점": 3 },
  
  // ★ 유일하게 '1전심'으로 표시된 과목 (주의 깊게 볼 것)
  { "학수번호": "HBJO0052", "교과목명": "웹서버프로그래밍(PBL)", "이수구분": "1전심", "학점": 3 },
  
  { "학수번호": "HBJO0053", "교과목명": "영상처리(PBL)", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJQ0026", "교과목명": "디지털포렌식", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJW0008", "교과목명": "웹프로그래밍", "이수구분": "1전선", "학점": 3 },
  { "학수번호": "HBJW0021", "교과목명": "인간-컴퓨터 상호작용(PBL)", "이수구분": "1전선", "학점": 3 }
];

const workbook = xlsx.utils.book_new();
const worksheet = xlsx.utils.json_to_sheet(myData);
xlsx.utils.book_append_sheet(workbook, worksheet, "성적표");

xlsx.writeFile(workbook, "test_score.xlsx");
console.log("✅ 실제 수강 내역이 담긴 'test_score.xlsx' 파일 생성 완료!");